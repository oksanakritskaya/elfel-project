{"version":3,"sources":["src/javascripts/form.ts"],"names":[],"mappings":"AAAA,UAAU,WAAW;IACjB,OAAO,EAAE,MAAM,CAAC;CACnB;AAED,aAAK,MAAM;IACP,GAAG,QAAQ;IACX,IAAI,SAAS;CAChB;AAED,iBAAS,GAAG,CAAC,CAAC,EAAE,KAAK,MAAM,EAAE,QAAQ,MAAM,EAAE,IAAI,CAAC,EAAE,GAAG,GAAG,OAAO,CAAC,CAAC,CAAC,CAqBnE","file":"index.d.ts","sourcesContent":["interface SmsResponse {\r\n    message: string;\r\n}\r\n\r\nenum Method {\r\n    GET = 'GET',\r\n    POST = 'POST'\r\n}\r\n\r\nfunction api<T>(url: string, method: Method, body?: any): Promise<T> {\r\n    return new Promise(function (resolve, reject) {\r\n        let params: RequestInit = {\r\n            method: method,\r\n            headers: {\r\n                'Content-Type': 'application/json'\r\n            }\r\n        };\r\n        if (body) {\r\n            params.body = JSON.stringify(body);\r\n        }\r\n        fetch(url, params)\r\n            .then(response => {\r\n                if (!response.ok) {\r\n                    response.json().then(text => reject(new Error(text.message)));\r\n                } else {\r\n                    resolve(response.json());\r\n                }\r\n            })\r\n            .catch((error) => reject(new Error(error)))\r\n    });\r\n}\r\n\r\ndocument.addEventListener(\"DOMContentLoaded\", () => {\r\n    const form: HTMLFormElement = document.forms[0];\r\n\r\n    form.addEventListener('submit', function (event) {\r\n        const smth: HTMLInputElement = <HTMLInputElement>form.userName;\r\n        const inputName: string = smth.value;\r\n        const smth2: HTMLInputElement = <HTMLInputElement>form.userTel;\r\n        const inputTel: string = smth2.value;\r\n        const button = <HTMLInputElement>form.buttonSend;\r\n        button.classList.add('button--sending')\r\n\r\n        api<SmsResponse>('/message', Method.POST, {text: `${inputName} ${inputTel.replace(/\\s/g, '')}`})\r\n            .then((data: SmsResponse) => {\r\n                button.innerText = `${data.message} Ожидайте звонка`;\r\n            })\r\n            .catch((error: Error) => {\r\n                button.innerText = `${error.message}. Пожалуйста, свяжитесь с нами самостоятельно`;\r\n            })\r\n            .finally(() => {\r\n                button.classList.remove('button--sending')\r\n                button.classList.add('button--sent');\r\n            })\r\n\r\n        event.preventDefault();\r\n    });\r\n});\r\n\r\n"]}